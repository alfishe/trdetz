<HTML>
<HEAD>
<meta http-equiv=Content-Type content="text/html; charset=koi8-r">
</HEAD>
<BODY>
<H1>TRDETZ - супирутилита для работы с TRD-образами!!!</H1>
(ц) <a href="mailto:boo_boo@inbox.ru">Бу-бу</a>
<BR>
<BR>
Trdetz (читается "Тырдец") это консольная утилита для работы с TRD-образами дисков компутера ZX-Spectrum. Тырдец оптимизирован для 
использования в скриптах (например мэйкфайлах -- шоб собрать бинарники кросс-ассемблером и автоматически запихнуть их на диск). 
Работает он практически в любой ОС для которой есть компилятор ANSI-C, тестировал я в Линухе и Винде(тм). Все операции производимые 
Тырдецом "атомарны" -- за раз он может записать/считать только один файл, или одну непрерывную группу секторов, или изменить один 
атрибут файла и тп. Это так специально, чтобы в скриптах Тырдец вёл себя органичнее.<BR>
<BR>
<B>Фичи:</B>
<UL>
<LI>Чтение/запись группы секторов из/в TRD
<LI>Чтение/запись бинарного файла из/в TRD (также поддерживаются hobeta-файлы)
<LI>Удаление файла
<LI>Изменение атрибутов файла (имя, расширение, длина и тд) 
<LI>Чтение информации о файле или всех файлах в TRD-каталоге
<LI>Чтение информации о TRD-диске
<LI>Уплотнение диска
<LI>Вывод пафосного хелпа
</UL>
<BR>
<B>Тырдец вызывается так:</B><BR>
<PRE>
trdetz [флаги] имя_трд_образа команда [аргументы]
</PRE>
<B>Флаги бывают такие:</B>
<UL>
<LI><TT>-df[=del_file_marker]</TT> : Работать также и с удаленными файлами. без этого флага Тырдец удаленных файлов замечать не будет. 
    С помощью этого флага можно восстанавливать удаленные файлы, путем их переименования. Необязательный параметр del_file_marker 
    задаёт символ, который будет использоваться для обозначения 1го символа имени удаленного файла, по умолчанию это вопросительный 
    знак. Вощем, с удаленными файлами можно работать в точности как с обычными если этот флаг включен.
<LI><TT>-fs</TT> : Считать длину файла в байтах не по соответствующему полю каталога, а как кол-во секторов помноженное на 256. 
    Это влияет на операции чтения файла из TRD-образа. <B><I>ВНИМАНИЕ!</I></B> этот флаг необходимо указывать при чтении с 
    TRD-образа файлов, реальная длина которых не соответствует указанной в каталоге, например, программ, 
    упакованных в один блок с бейсик-загрузчиком.
<LI><TT>-hob</TT> : Работа с форматом hobeta при экспорте и импорте TR-DOS файла. Работает для команд fread и fwrite. То есть, в fread 
    можно вместо простого бинарного файла извлекать с TRD-образа hobeta-файл, а в fwrite записывать данные из hobeta-файла в TRD.
</UL>
<BR>
Теперь про команды. Сразу имейте в виду, что команды принимают всякие параметры, которые бывают текстовыми или числовыми. 
Числовые параметры можно писать в 10-чной, 16-чной или 8-ичной системах счисления. Если перед числом стоит префикс "0x" то 
оно значит 16-иричное, а если оно начинается с нуля, то восьмеричное. Ага, и еще если никакой воще команды не писать, 
то Тырдец покажет хелп.
<BR>
<BR>
<B>Команды Тырдеца</B> ("имя_файла" означает файл на TRD-образе, а "имя_файла_ОС" -- файл операцыонной системы):
<UL>
<LI><TT>dinfo</TT> : Показывает инфу о образе -- имя диска и прочую муть. выдается по одному полю на строку.
<LI><TT>cat [имя_файла]</TT> : Если задано имя файла показывает инфу об этом файле, иначе обо всех файлах на диске. Формат 
инфы такой же, как в TR-DOSной команде LIST, только в конце еще кажутся начальный трек и начальный сектор.
<LI><TT>secread имя_файла_ОС начальный_трек начальный_сектор кол-во_секторов</TT> : Чтение группы секторов из TRD-образа.
<LI><TT>secwrite имя_файла_ОС начальный_трек начальный_сектор кол-во_секторов</TT> : Запись группы секторов на TRD-образ.
<LI><TT>fread имя_trd_файла [имя_файла_ОС]</TT> : Чтение файла с TRD-образа. Если задан параметр имя_файла_ОС, 
файл будет записан с этим именем, а не тем, что в каталоге.
<LI><TT>fwrite имя_файла_ОС [имя_файла]</TT> : Запись файла на TRD-образ. Если задан параметр имя_файла, он будет записан под этим 
именем, иначе имя будет сформировано из имени файла-источника.
<LI><TT>del имя_файла</TT> : Удаление файла. Если файл находится в конце каталога, его уже после этого не вернешь, 
иначе можно потом восстановить.
<LI><TT>move</TT> : Уплотнение диска (как TRDOSная команда move).
<LI><TT>ren старое_имя_файла новое_имя_файла</TT> : Переименование файла, а также восстановление удалённых (см флаг -df). 
<LI><TT>fprop имя_файла имя_атрибута значение_атрибута</TT> : Изменение атрибута файла. атрибуты бывают такие:
<UL>
<LI><TT>start</TT> : Начальный адрес кодового файла (а для васика это полная длина).
<LI><TT>flen</TT> : Длина файла (для васика тут длина только программной части).
<LI><TT>nsec</TT> : Скока секторов файл занимает.
</UL>
</UL>
<BR>
<B>Компиляция Тырдеца:</B><BR>
<BR>
Как я уже наверно говорил, Тырдец должен компилироваться любым ANSI-C компилятором. Однако я пробовал только GCC (и, соответственно, 
MinGW под Виндовсом). В случае использования этих компиляторов и GNU make, достаточно сказать "make all" и все скомпилится. 
Если у вас другие компиляторы/мейки/девстудии, курите их мануал, создавайте проекты и всякую такую бадягу сами. Юзаются тока 
стандартные сишные либы, так что порблем быть не должно :)
<br><br>
Ну и если вам достался Тырдец без исходников, или нашелся глюк, пишите мне на адрес который гдето вверху этого хелпа.
<BR>
<BR>
Speccy фарева! Ура!
</BODY>
</HTML>